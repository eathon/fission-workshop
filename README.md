# Fission Workshop

## CockroachDB Connection Information

* DB language support (use raw SQL)
  * Go: https://www.cockroachlabs.com/docs/stable/build-a-go-app-with-cockroachdb.html#insecure
  * Python: https://www.cockroachlabs.com/docs/stable/build-a-python-app-with-cockroachdb.html#insecure
  * Node.js: https://www.cockroachlabs.com/docs/stable/build-a-nodejs-app-with-cockroachdb.html#insecure

* Connection detail
  * host: cockroachdb.fission-workshop
  * port: 26257
  * user: root
  * database: guestbook

* Table scheme
  * The value of id field is generated by database automatically.

  ```
  +---------+--------+-------+-------------------+-------------+
  |  Field  |  Type  | Null  |      Default      |   Indices   |
  +---------+--------+-------+-------------------+-------------+
  | id      | UUID   | false | gen_random_uuid() | {"primary"} |
  | message | STRING | true  | NULL              | {}          |
  | user    | STRING | true  | NULL              | {}          |
  +---------+--------+-------+-------------------+-------------+
  
  +--------------------------------------+-------------------------+-----------------+
  |                  id                  |         message         |      user       |
  +--------------------------------------+-------------------------+-----------------+
  | 1f17cf1f-b3ec-4fd3-ba88-250bdfa37a8d | new message             | dummy-user-name |
  | de69ee77-fc6c-4650-a77c-c6ab0344e49e | this is dummy message 2 | dummy-user-name |
  +--------------------------------------+-------------------------+-----------------+
  ```
  
* SQL syntax
  ```
  INSERT INTO guestbook.messages ("message", "user") VALUES ('this is dummy message 1', 'dummy-user-name')
  UPDATE guestbook.messages SET "message"='asdasd' WHERE "id"='12312'
  SELECT * FROM guestbook.messages
  DELETE FROM guestbook.messages WHERE "id"='12313'
  ```


## Guestbook Specification

* HTTP trigger URL format

```
POST http://$FISSION_ROUTER/<your-nick-name>/guestbook/messages

GET http://$FISSION_ROUTER/<your-nick-name>/guestbook/messages
GET http://$FISSION_ROUTER/<your-nick-name>/guestbook/messages/{id}

UPDATE http://$FISSION_ROUTER/<your-nick-name>/guestbook/messages/{id}

DELETE http://$FISSION_ROUTER/<your-nick-name>/guestbook/messages/{id}
```

* Return messages in JSON format
```
[
    {
        "id": "1f17cf1f-b3ec-4fd3-ba88-250bdfa37a8d",
        "message": "this is dummy message body",
        "user": "foobar"
    },
    {
        "id": "1f17cf1f-b3ec-4fd3-ba88-250bd12312331",
        "message": "this is dummy message body 2",
        "user": "foobar2"
    }
]
```
